(function(){"use strict";function i(){if(r){requestAnimFrame(i);for(var e=0,t=n.length;e<t;e++){n[e].update()}}}function s(s,a){if(!s.nodeName||/^(ul|li)$/i.test(s.nodeName)===false){return false}else if(u(s)){o(s)}var f=t?new c(s):new l(s);if(a&&a.live){f.syncInterval=setInterval(function(){f.sync.call(f)},e)}f.sync();n.push(f);if(n.length===1){r=true;i()}}function o(e){for(var t=0;t<n.length;t++){var i=n[t];if(i.element==e){i.destroy();n.splice(t,1);t--}}if(n.length===0){r=false}}function u(e){for(var t=0,r=n.length;t<r;t++){if(n[t].element==e){return true}}return false}function a(e,t,n){var r,i;if(typeof e==="string"){var s=document.querySelectorAll(e);for(r=0,i=s.length;r<i;r++){t.call(null,s[r],n)}}else if(typeof e==="object"&&typeof e.length==="number"){for(r=0,i=e.length;r<i;r++){t.call(null,e[r],n)}}else if(e.nodeName){t.call(null,e,n)}else{throw"Stroll target was of unexpected type."}}function f(){return!!document.body.classList}function l(e){this.element=e}function c(e){this.element=e;this.element.style.overflow="hidden";this.top={value:0,natural:0};this.touch={value:0,offset:0,start:0,previous:0,lastMove:Date.now(),accellerateTimeout:-1,isAccellerating:false,isActive:false};this.velocity=0}var e=500;var t=!!("ontouchstart"in window);var n=[];var r=false;l.prototype.sync=function(){this.items=Array.prototype.slice.apply(this.element.children);this.listHeight=this.element.offsetHeight;for(var e=0,t=this.items.length;e<t;e++){var n=this.items[e];n._offsetHeight=n.offsetHeight;n._offsetTop=n.offsetTop;n._offsetBottom=n._offsetTop+n._offsetHeight;n._state=""}this.update(true)};l.prototype.update=function(e){var t=this.element.pageYOffset||this.element.scrollTop,n=t+this.listHeight;if(t!==this.lastTop||e){this.lastTop=t;for(var r=0,i=this.items.length;r<i;r++){var s=this.items[r];if(s._offsetBottom<t){if(s._state!=="past"){s._state="past";s.classList.add("past")}}else if(s._offsetTop>n){if(s._state!=="future"){s._state="future";s.classList.add("future")}}else if(s._state){if(s._state==="past")s.classList.remove("past");if(s._state==="future")s.classList.remove("future");s._state=""}}}};l.prototype.destroy=function(){clearInterval(this.syncInterval);for(var e=0,t=this.items.length;e<t;e++){var n=this.items[e];n.classList.remove("past");n.classList.remove("future")}};c.prototype=new l;c.prototype.sync=function(){this.items=Array.prototype.slice.apply(this.element.children);this.listHeight=this.element.offsetHeight;var e;for(var t=0,n=this.items.length;t<n;t++){e=this.items[t];e._offsetHeight=e.offsetHeight;e._offsetTop=e.offsetTop;e._offsetBottom=e._offsetTop+e._offsetHeight;e._state="";e.style.opacity=1}this.top.natural=this.element.scrollTop;this.top.value=this.top.natural;this.top.max=e._offsetBottom-this.listHeight;this.update(true);this.bind()};c.prototype.bind=function(){var e=this;this.touchStartDelegate=function(t){e.onTouchStart(t)};this.touchMoveDelegate=function(t){e.onTouchMove(t)};this.touchEndDelegate=function(t){e.onTouchEnd(t)};this.element.addEventListener("touchstart",this.touchStartDelegate,false);this.element.addEventListener("touchmove",this.touchMoveDelegate,false);this.element.addEventListener("touchend",this.touchEndDelegate,false)};c.prototype.onTouchStart=function(e){e.preventDefault();if(e.touches.length===1){this.touch.isActive=true;this.touch.start=e.touches[0].clientY;this.touch.previous=this.touch.start;this.touch.value=this.touch.start;this.touch.offset=0;if(this.velocity){this.touch.isAccellerating=true;var t=this;this.touch.accellerateTimeout=setTimeout(function(){t.touch.isAccellerating=false;t.velocity=0},500)}else{this.velocity=0}}};c.prototype.onTouchMove=function(e){if(e.touches.length===1){var t=this.touch.value;this.touch.value=e.touches[0].clientY;this.touch.lastMove=Date.now();var n=this.touch.value>this.touch.previous&&this.velocity<0||this.touch.value<this.touch.previous&&this.velocity>0;if(this.touch.isAccellerating&&n){clearInterval(this.touch.accellerateTimeout);this.velocity+=(this.touch.previous-this.touch.value)/10}else{this.velocity=0;this.touch.isAccellerating=false;this.touch.offset=Math.round(this.touch.start-this.touch.value)}this.touch.previous=t}};c.prototype.onTouchEnd=function(e){var t=this.touch.start-this.touch.value;if(!this.touch.isAccellerating){this.velocity=(this.touch.start-this.touch.value)/10}if(Date.now()-this.touch.lastMove>200||Math.abs(this.touch.previous-this.touch.value)<5){this.velocity=0}this.top.value+=this.touch.offset;this.touch.offset=0;this.touch.start=0;this.touch.value=0;this.touch.isActive=false;this.touch.isAccellerating=false;clearInterval(this.touch.accellerateTimeout);if(Math.abs(this.velocity)>4||Math.abs(t)>10){e.preventDefault()}};c.prototype.update=function(e){var t=this.top.value+this.velocity+this.touch.offset;if(this.velocity||this.touch.offset){this.element.scrollTop=t;t=Math.max(0,Math.min(this.element.scrollTop,this.top.max));this.top.value=t-this.touch.offset}if(!this.touch.isActive||this.touch.isAccellerating){this.velocity*=.95}if(Math.abs(this.velocity)<.15){this.velocity=0}if(t!==this.top.natural||e){this.top.natural=t;this.top.value=t-this.touch.offset;var n=t+this.listHeight;for(var r=0,i=this.items.length;r<i;r++){var s=this.items[r];if(s._offsetBottom<t){if(this.velocity<=0&&s._state!=="past"){s.classList.add("past");s._state="past"}}else if(s._offsetTop>n){if(this.velocity>=0&&s._state!=="future"){s.classList.add("future");s._state="future"}}else if(s._state){if(s._state==="past")s.classList.remove("past");if(s._state==="future")s.classList.remove("future");s._state=""}}}};c.prototype.destroy=function(){l.prototype.destroy.apply(this);this.element.removeEventListener("touchstart",this.touchStartDelegate,false);this.element.removeEventListener("touchmove",this.touchMoveDelegate,false);this.element.removeEventListener("touchend",this.touchEndDelegate,false)};window.stroll={bind:function(e,t){if(f()){a(e,s,t)}},unbind:function(e){if(f()){a(e,o)}}};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}()})()